
1. 9Documentation Guidelines

### Write comments and documentation in US English  (AV2301) ![](images/?.png)

### Document all public, protected and internal types and members  (AV2305) ![](images/?.png)

Documenting your code allows Visual Studio to pop-up the documentation when your class is used somewhere else. Furthermore, by properly documenting your classes, tools can generate professionally looking class documentation.

### Write XML documentation with another developer in mind  (AV2306) ![](images/?.png)

Write the documentation of your type with another developer in mind. Assume he or she will not have access to the source code and try to explain how to get the most out of the functionality of your type.

### Write MSDN-style documentation  (AV2307) ![](images/?.png)

Following the MSDN on-line help style and word choice helps the developer to find its way through your documentation more easily.

**Tip** The tool [GhostDoc](http://submain.com/products/ghostdoc.aspx)can generate a starting point for documenting code with a shortcut key.

### Avoid inline comments  (AV2310) ![](images/?.png)

If you feel the need to explain a block of code using a comment, consider replacing that block with a method having a clear name.

### Only write comments to explain complex algorithms or decisions  (AV2316) ![](images/?.png)

Try to focus comments on the _why_ and _what_ of a code block and not the _how_. Avoid explaining the statements in words, but instead help the reader understand why you chose a certain solution or algorithm and what you are trying to achieve. If applicable, also mention that you chose an alternative solution because you ran into a problem with the obvious solution.

### Don't use comments for tracking work to be done later  (AV2318) ![](images/?.png)

Annotating a block of code or some work to be done using a TODO or similar comment may seem a reasonable way of tracking work-to-be-done. But in reality, nobody really searches for comments like that. Use a work item tracking system such as Team Foundation Server to keep track of left overs.

1. 10Layout Guidelines

### Use a common layout  (AV2400) ![](images/?.png)

- Keep the length of each line under 130 characters.
- Use an indentation of 4 whitespaces, and don't use tabs
- Keep one whitespace between keywords like if and the expression, but don't add whitespaces after ( and before ) such as: if (condition == null).
- Add a whitespace around operators, like +, -, ==, etc.
- Always succeed the keywords if, else, do, while, for and foreach, with opening and closing parentheses, even though the language does not require it. 
- Always put opening and closing parentheses on a new line.
- Don't indent object Initializers and initialize each property on a new line, so use a format like this: var dto = new ConsumerDto(){  Id = 123,  Name = "Microsoft",  PartnerShip = PartnerShip.Gold,}
- Don't indent lambda statements and use a format like this:methodThatTakesAnAction.Do(x =>{ // do something like this }
- Put the entire LINQ statement on one line, or start each keyword at the same indentation, like this:var query = from product in products where product.Price > 10 select product;orvar query =  from product in products  where product.Price > 10  select product;
- Start the LINQ statement with all the from expressions and don't interweave them with where restrictions.
- Add braces around every comparison condition, but don't add braces around a singular condition. For exampleif (!string.IsNullOrEmpty(str) && (str != "new"))
- Add an empty line between multi-line statements, between members, after the closing parentheses, between unrelated code blocks, around the #region keyword, and between the using statements of different companies.

### Order and group namespaces according the company  (AV2402) ![](images/?.png)

// Microsoft namespaces are first

using System;

using System.Collections;

using System.XML;

// Then any other namespaces in alphabetic order

using AvivaSolutions.Business;

using AvivaSolutions.Standard;

using Telerik.WebControls;

using Telerik.Ajax;

### Place members in a well-defined order  (AV2406) ![](images/?.png)

Maintaining a common order allows other team members to find their way in your code more easily. In general, a source file should be readable from top to bottom, as if you are reading a book. This prevents readers from having to browse up and down through the code file.

1. Private fields and constants (in a region)
2. Public constants
3. Public read-only static fields
4. Factory Methods
5. Constructors and the Finalizer
6. Events 
7. Public Properties
8. Other methods and private properties in calling order

### Be reluctant with #regions  (AV2407) ![](images/?.png)

Regions can be helpful, but can also hide the main purpose of a class. Therefore, use #regions only for:

- Private fields and constants (preferably in a Private Definitions region).
- Nested classes
- Interface implementations (only if the interface is not the main purpose of that class)

1. 11Important Resources
  1. 1 [The](http://www.csharpcodingguidelines.com) companion website

This document is part of an effort to increase the consciousness with which C# developers do their daily job on a professional level. Therefor I've started a dedicated CodePlex site that can be easily found using the URL [www.csharpcodingguidelines.com](http://www.csharpcodingguidelines.com).

In addition to the most up to date version of this document, you'll find:

- A companion quick-reference sheet
- Visual Studio 2010/2012 Rule Sets for different types of systems.

[ReSharper](http://www.jetbrains.com/resharper/download/) layout configurations matching the rules in chapter 10.

- A place to have discussions on C# coding quality.

1. 
  1. 2Useful links

In addition to the many links provided throughout this document, I'd like to recommend the following books, articles and sites for everyone interests in software quality,

[Code Complete: A Practical Handbook of Software Construction](http://www.amazon.com/Code-Complete-Practical-Handbook-Construction/dp/0735619670) (Steve McConnel)  
One of the best books I've ever read. It deals with all aspects of software development, and even though the book was originally written in 2004, but you'll be surprised when you see how accurate it still is. I wrote a [review](http://www.dennisdoomen.net/2009/07/book-review-code-complete-2nd-edition.htmlhttp:/www.dennisdoomen.net/2009/07/book-review-code-complete-2nd-edition.html) in 2009 if you want to get a sense of its contents.

[The Art of Agile Development](http://www.amazon.com/Art-Agile-Development-James-Shore/dp/0596527675) (James Shore)  
Another great all-encompassing trip through the many practices preached by processes like Scrum and Extreme Programming. If you're looking for a quick introduction with a pragmatic touch, make sure you read James' book.

[Applying Domain Driven-Design and Patterns: With Examples in C# and .NET](http://www.amazon.com/Applying-Domain-Driven-Design-Patterns-Examples/dp/0321268202) (Jimmy Nilsson)  
The book that started my interest for both Domain Driven Design and Test Driven Development. It's one of those books that I wished I had read a few years earlier. It would have saved me from many mistakes..

[Jeremy D. Miller's Blog](http://codebetter.com/blogs/jeremy.miller/)  
Although he is not that active anymore, in the last couple of years he has written some excellent blog posts on Test Driven Development, Design Patterns and design principles. I've learned a lot from his real-life and practical insights.

[LINQ Framework Design Guidelines](http://blogs.msdn.com/b/mirceat/archive/2008/03/13/linq-framework-design-guidelines.aspx)  
A set of rules and recommendations that you should adhere to when creating your own implementations of IQueryable.

[Best Practices for c# async/await](http://code.jonwagner.com/2012/09/06/best-practices-for-c-asyncawait/)  
The rationale and source of several of the new guidelines in this documented, written by [Jon Wagner](https://twitter.com/jonwagnerdotcom).
